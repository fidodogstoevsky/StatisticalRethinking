---
title: "Statistical Rethinking: Chapter 2"
output:
  html_document:
    code_folding: hide   # or "show" to expand by default
date: "`r Sys.Date()`"
author: "Gidon Kaminer"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Easy Exercises

**Exercise 1.** Which of the expressions below correspond to the statement: _the probability of rain on Monday_?

1. $P(rain)$ **No.** This just expresses the probability of rain in general.
2. $P(rain|Monday)$ **Yes.** This expresses the probability of rain, given that it's Monday.
3. $P(Monday|rain)$ **No.** This expresses the probability of it being Monday, given that it's raining.
4. $P(rain,Monday)/P(Monday)$ **Yes.** $P(rain,Monday)$ is the joint probability that, on a given day, it is Monday and it is raining. This is equivalent to $P(rain|Monday)P(Monday)$, the probability of rain given that it's Monday, times the probability that it's Monday. Since we also have $P(Monday)$ in the denominator, it cancels out and we are left with $P(rain|Monday)$. 

**Exercise 2.** Which of the following statements corresponds to the expression _P(Monday|rain)_?

1. _The probability of rain on Monday._ **No.** That would be the conditional probability $P(rain|Monday)$.
2. _The probability of rain, given that it is Monday._ **No.** That would be the conditional probability $P(rain|Monday)$.
3. _The probability that it is Monday, given that it is raining._ **Yes.** That is $P(Monday|rain)$. 
4. _The probability that it is Monday and that it is raining._ **No.** That would be the joint probability $P(rain, Monday)$.

**Exercise 3.** Which of the expressions below correspond to the statement: _the probability that it is Monday, given that it is raining_?

1. $P(Monday|rain)$ **Yes.** This expresses the probability of it being Monday, given that there is rain.
2. $P(rain|Monday)$ **No.** This expresses the probability that it is raining, given that it's Monday.
3. $P(rain|Monday)P(Monday)$ No. This expresses the probability that if it's Monday then it's raining, times the probability that it's Monday. So it expresses the probability that it's raining, P(rain).
4. $P(rain|Monday)P(Monday)/P(rain)$ **Yes.** By Bayes' Theorem, this expresses $P(Monday|rain)$.
5. $P(Monday|rain)P(rain)/P(Monday)$ **No.** By Bayes' Theorem, this expresses $P(rain|Monday)$.

*Exercise 4.* In the context of the globe-tossing example, to say "the probability of water is $0.7$" means 

## Medium Exercises

**Exercise 1.** Recall the globe-tossing model. Compute and plot the grid approximate posterior distribution for each of the following sets of observations. In each case, assume a uniform posterior for $p$. 

```{r 2m1_1}
# number of water observations
w <- 3
# number of land observations
l <- 0
# total number of observations
n <- w + l
# define grid
p_grid <- seq( from=0 , to=1 , length.out=20 )
# define prior
prior <- rep( 1 , 20 )
# compute likelihood at each value in grid
likelihood <- dbinom( w , size=n , prob=p_grid )
# compute product of likelihood and prior
unstd.posterior <- likelihood * prior
# standardize the posterior, so it sums to 1
posterior <- unstd.posterior / sum(unstd.posterior)
# display the prior distribution
plot( p_grid , posterior , type="b" , xlab="probability of water" , ylab="posterior probability" )
mtext( "1. Observations: {W,W,W}" )
```

```{r 2m1_2}
w <- 3
l <- 1
n <- w + l
p_grid <- seq( from=0 , to=1 , length.out=20 )
prior <- rep( 1 , 20 )
likelihood <- dbinom( w , size=n , prob=p_grid )
unstd.posterior <- likelihood * prior
posterior <- unstd.posterior / sum(unstd.posterior)
plot( p_grid , posterior , type="b" , xlab="probability of water" , ylab="posterior probability" )
mtext( "2. Observations: {W,W,W,L}" )
```

```{r 2m1_3}
w <- 5
l <- 2
n <- w + l
p_grid <- seq( from=0 , to=1 , length.out=20 )
prior <- rep( 1 , 20 )
likelihood <- dbinom( w , size=n , prob=p_grid )
unstd.posterior <- likelihood * prior
posterior <- unstd.posterior / sum(unstd.posterior)
plot( p_grid , posterior , type="b" , xlab="probability of water" , ylab="posterior probability" )
mtext( "2. Observations: {L,W,W,L,W,W,W}" )
```

**Exercise 2.** Now assume a prior for $p$ that is equal to zero when $p < 0.5$ and is a positive constant when $p \geq 0.5$. Again compute and plot the grid approximate posterior distribution for each of the sets of observations in the problem just above. 

```{r 2m2_1}
# number of water observations
w <- 3
# number of land observations
l <- 0
# total number of observations
n <- w + l
# define grid
p_grid <- seq( from=0 , to=1 , length.out=20 )
# prior is 0 if p<0.5
prior <- ifelse(p_grid >= 0.5, 1, 0)
# compute likelihood at each value in grid
likelihood <- dbinom( w , size=n , prob=p_grid )
# compute product of likelihood and prior
unstd.posterior <- likelihood * prior
# standardize the posterior, so it sums to 1
posterior <- unstd.posterior / sum(unstd.posterior)
# display the prior distribution
plot( p_grid , posterior , type="b" , xlab="probability of water" , ylab="posterior probability" )
mtext( "1. Observations: {W,W,W}" )
```

```{r 2m2_2}
w <- 3
l <- 1
n <- w + l
p_grid <- seq( from=0 , to=1 , length.out=20 )
prior <- ifelse(p_grid >= 0.5, 1, 0)
likelihood <- dbinom( w , size=n , prob=p_grid )
unstd.posterior <- likelihood * prior
posterior <- unstd.posterior / sum(unstd.posterior)
plot( p_grid , posterior , type="b" , xlab="probability of water" , ylab="posterior probability" )
mtext( "2. Observations: {W,W,W,L}" )
```

```{r 2m2_3}
w <- 5
l <- 2
n <- w + l
p_grid <- seq( from=0 , to=1 , length.out=20 )
prior <- ifelse(p_grid >= 0.5, 1, 0)
likelihood <- dbinom( w , size=n , prob=p_grid )
unstd.posterior <- likelihood * prior
posterior <- unstd.posterior / sum(unstd.posterior)
plot( p_grid , posterior , type="b" , xlab="probability of water" , ylab="posterior probability" )
mtext( "2. Observations: {L,W,W,L,W,W,W}" )
```

